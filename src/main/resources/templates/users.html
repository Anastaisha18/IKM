<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CRM - Сотрудники</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
<header class="header">
    <h1><i class="bi bi-people"></i> Управление сотрудниками CRM</h1>
    <p class="subtitle">Управление сотрудниками компании</p>
</header>

<nav class="main-nav">
    <ul class="nav-menu">
        <li class="nav-item">
            <a href="/users" class="nav-link active">
                <i class="bi bi-people"></i> Сотрудники
            </a>
        </li>
        <li class="nav-item">
            <a href="/clients" class="nav-link">
                <i class="bi bi-building"></i> Клиенты
            </a>
        </li>
        <li class="nav-item">
            <a href="/deals" class="nav-link">
                <i class="bi bi-cash-coin"></i> Сделки
            </a>
        </li>
        <li class="nav-item">
            <a href="/" class="nav-link">
                <i class="bi bi-house"></i> На главную
            </a>
        </li>
    </ul>
</nav>

<div class="action-panel">
    <div class="search-form">
        <select class="search-select">
            <option value="">Все роли</option>
            <option value="менеджер">Менеджер</option>
            <option value="старший менеджер">Старший менеджер</option>
            <option value="руководитель">Руководитель</option>
            <option value="администратор">Администратор</option>
        </select>
        <input type="text" class="search-input" placeholder="Поиск сотрудников...">
        <button class="btn btn-primary">Найти</button>
    </div>
    <a href="/users/new" class="btn btn-success">
        <i class="bi bi-plus-circle"></i> Добавить сотрудника
    </a>
</div>

<div class="info-bar">
    <span>Всего сотрудников: <strong th:text="${#lists.size(users)}">0</strong></span>
</div>

<div class="table-container">
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Фамилия</th>
            <th>Имя</th>
            <th>Отчество</th>
            <th>Email</th>
            <th>Роль</th>
            <th class="actions-column">Действия</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}" th:if="${users != null and !users.empty}">
            <td><span class="status-badge status-inactive" th:text="${user.id}"></span></td>
            <td th:text="${user.lastName}"></td>
            <td th:text="${user.firstName}"></td>
            <td th:text="${user.patronymic} ?: 'Не указано'"></td>
            <td>
                <div class="contact-info" th:if="${user.email}">
                    <i class="bi bi-envelope contact-icon"></i>
                    <a th:href="'mailto:' + ${user.email}" th:text="${user.email}"></a>
                </div>
                <span th:unless="${user.email}" class="text-muted">Не указан</span>
            </td>
            <td>
                <span class="role-badge" th:text="${user.role}"></span>
            </td>
            <td class="actions-column">
                <div class="actions">
                    <a th:href="@{/users/view/{id}(id=${user.id})}"
                       class="btn btn-info btn-small" title="Просмотр">
                        <i class="bi bi-eye"></i>
                    </a>
                    <a th:href="@{/users/edit/{id}(id=${user.id})}"
                       class="btn btn-warning btn-small" title="Редактировать">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a th:href="@{/users/delete/{id}(id=${user.id})}"
                       class="btn btn-danger btn-small" title="Удалить"
                       onclick="return confirm('Удалить сотрудника?')">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
            </td>
        </tr>
        <tr th:if="${users == null or users.empty}">
            <td colspan="7">
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="bi bi-people"></i>
                    </div>
                    <h2>Сотрудники не найдены</h2>
                    <p>Добавьте первого сотрудника в систему</p>
                    <a href="/users/new" class="btn btn-success">
                        <i class="bi bi-plus-circle"></i> Добавить сотрудника
                    </a>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<footer style="text-align: center;">
    <p>CRM System v1.0 | © 2025</p>
</footer>
</body>
</html>